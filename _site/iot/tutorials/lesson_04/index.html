<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="pfactor.io provides tutorials, blog posts and resources for electronics and aviation enthusiasts.
" />
    <meta name="author" content="" />

  <title>Lesson 4: Driving Miss Daisy!</title>
  
  <!-- Open Graph Meta Tags -->
  
  <meta property="og:url" content="http://pfactor.io/iot/tutorials/lesson_04/" />
  <meta property="og:title" content="Lesson 4: Driving Miss Daisy!" />
  <meta property="og:description" content="Motors, and motor drives are, perhaps, the most fun aspects of electronics. The very thought of converting electrical pulses into mechanical energy is amazin..." />
  <meta property="og:site_name" content="PFactor" />
  <meta property="og:type" content="article" />
  <!-- End Open Graph Meta Tags -->

    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link href="/css/modern-business.css" rel="stylesheet" />

    <!-- Custom Fonts -->
<!--    
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
-->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js" /></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js" /></script>
    <![endif]-->

  <link rel="canonical" href="http://pfactor.io/iot/tutorials/lesson_04/" />
  <link rel="alternate" type="application/rss+xml" title="PFactor.io" href="http://pfactor.io///feed.xml" />
  <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
	});
	MathJax.Hub.Config({
		"HTML-CSS": { preferredFont: "STIX" }
	});
  </script>
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  
</head>


  <body>

        <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">PFactor.io</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                     
                    
                    
                    <li>
                        <a href="/aviation/">Aviation</a>
                    </li>
                     
                    
                    
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">IoT <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                               
                            <li>
                                <a href="/iot/">Home</a>
                            </li>
                                
                            <li>
                                <a href="/iot/tutorials/">Tutorials</a>
                            </li>
                      
                        </ul> <!-- /.dropdown-menu -->
                    </li> <!-- /.dropdown -->
                     
                    
                
                  <li>
                  <a href="https://facebook.com/pages/pfactorio/1427400607569811"><i class="fa fa fa-facebook-square fa-lg"></i></a>
                  </li>
                
                
                  <li>
                  <a href="http://twitter.com/pfactorio/"><i class="fa fa fa-twitter-square fa-lg"></i></a>
                  </li>
                                
                
                  <li>
                  <a href="http://github.com/pfactorio/"><i class="fa fa fa-github-square fa-lg"></i></a>
                  </li>
                
                </ul>

            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>


    


    <!-- Page Content -->
    <div class="container">

      
<ul class="breadcrumb">
  
  
  <li>
    <a href="/">Home</a>
    <span class="divider"></span>
  </li>
  
  
  
   <li>
    
    
    
    <a href="/iot/">Iot</a>
  <span class="divider"></span>
  </li>
  
  
   <li>
    
    
    
    
    
    <a href="/iot/tutorials/">Tutorials</a>
  <span class="divider"></span>
  </li>
  
  <li class="active">Lesson 4: Driving Miss Daisy!</li>
  
</ul>

<div class="post">

<header class="post-header">
    <h1 class="post-title">Lesson 4: Driving Miss Daisy!</h1>
    <p class="post-meta">May 20, 2015</p>
  </header>

  <article class="post-content">
    <p>Motors, and motor drives are, perhaps, the most fun aspects of electronics. The very thought of converting electrical pulses into mechanical energy is amazing to the human mind. Motors power a wide variety of physical objects in our world - from cell phone buzzers to robots to electric cars.</p>

<h2 id="lesson-outline">Lesson Outline</h2>
<p>In this lesson we will</p>

<ol>
  <li>Examine how the following three types of motors work:
    <ul>
      <li>DC motors</li>
      <li>Stepper motors</li>
      <li>Servo motors</li>
    </ul>
  </li>
  <li>
    <p>Identify appropriate methods to drive these motors from an Arduino.</p>
  </li>
  <li>Write programs to control these motors using their drive circuits, and available Arduino libraries.</li>
</ol>

<h2 id="dc-motors">DC Motors</h2>
<p>DC motors are perhaps the simplest motors to understand. A current flows through a coil that is placed within a magnetic field that is generated by permanent magnets. The interaction between the electromagnetic field (generated when the current flows through the coil) and the magnetic field from the permanent magnets results in a perpendicular force being generated on the coil (look at <a href="http://en.wikipedia.org/wiki/Fleming%27s_left-hand_rule_for_motors">Fleming’s Left Hand Rule</a>) for more details.</p>

<p>The figure below (from Wikimedia Commons) shows the internal structure of a typical DC motor.</p>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/0/04/Electric_motor_cycle_2.png" alt="DC Motor Structure (Source: Wikimedia Commons)" /></p>

<p>The speed at which a DC motor rotates is directly proportional to the voltage that is applied across it. The direction in which the motor rotates (clockwise or anticlockwise) is determined by the polarity of the voltage applied across the motor - reverse the polarity and the motor will reverse its rotation.</p>

<h3 id="controlling-motor-speed-pwm">Controlling Motor Speed: PWM</h3>
<p>As we said above, the speed of the motor is controlled by the voltage that is applied across its terminals. Apply a lower voltage, and the speed is lower than that obtained by applying a higher voltage.</p>

<p>One technique for controlling the analog voltage through the use of digital signals is called <strong>Pulse Width Modulation (PWM)</strong>. PWM signals vary the ratio of the time that a signal is switched on to the time that the signal is switched off when generating signals with a constant frequency. This ratio is called the <strong>duty cycle</strong>.</p>

<p>For an illustration, look at the following figure (from the Arduino web site).</p>

<p><img src="http://arduino.cc/en/uploads/Tutorial/pwm.gif" alt="Pulse Width Modulation" /></p>

<p>The figure shows a typical set of PWM waveforms with varying duty cycles. Note that the frequency of the waveforms is the same in every row of the illustration. However, the length of time (and, hence, the width) that the pulse stays on varies depending on the argument to the <code>analogWrite</code> function. With a 50% duty cycle (<code>analogWrite(127)</code>) the pulse stays on for half the time period of the wave. Due to the inherent inertia of the electrical system that is being controlled (e.g. a motor) the system perceives the voltage of a 50% PWM signal to be half of the supply voltage.</p>

<p>For PWM to work, the switching frequency must be significantly higher than that <em>perceived</em> by the load. Typical switching frequencies for DC motors are in the one to ten kilohertz range. Unfortunately, the PWM output on the Arduino Uno runs at either 490 Hz or 980 Hz (pins 5 and 6 only), but it seems to suffice for most hobby projects. Note that this is not so much a limitation of the ATMega hardware, as it is a limitation of the Arduino firmware.</p>

<h3 id="controlling-motor-direction-h-bridge">Controlling Motor Direction: H-Bridge</h3>
<p>There are a number of ways of controlling the direction of rotation of a DC motor, but the most common is the “H-bridge”, named after the H-shaped layout of switches in the circuit. The figure below (from Wikimedia Commons) shows the notional representation of an H-bridge circuit for controlling a DC motor.</p>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/d/d4/H_bridge.svg" alt="H-Bridge Notional Representation" /></p>

<p>So, how does this circuit work?</p>

<p>To rotate the motor in one direction (let’s call it the “forward” direction) switches S1 and S4 are closed. Current flows through the motor from the top-left, to the bottom-right. The current flow in the motor is from its left terminal to its right.</p>

<p>To rotate the motor in the opposite direction (let’s call it the “reverse” direction) switches S1 and S4 are opened, and switches S3 and S2 are closed. Current flows from the top-right to the bottom-left, and within the motor it flows from the right to the left, thereby reversing its direction.</p>

<p>To let the motor “coast” to a stop, open all the switches. This removes all sources of electricity from reaching the motor, and lets it gradually come to a stop. If you want to brake (or rapidly stop) the motor, you do that by creating a short circuit between the two terminals of the motor. This is accomplished by closing S2 and S4, and leaving S1 and S3 open.</p>

<p>Here is a basic truth table for the H-Bridge circuit:</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th style="text-align: center">S1</th>
      <th style="text-align: center">S2</th>
      <th style="text-align: center">S3</th>
      <th style="text-align: center">S4</th>
      <th style="text-align: center">Output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">Forward</td>
    </tr>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">Reverse</td>
    </tr>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">Brake</td>
    </tr>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">Coast</td>
    </tr>
  </tbody>
</table>

<h4 id="flyback-diodes-or-clamp-diodes">Flyback Diodes or Clamp Diodes</h4>
<p>When using H-bridges (or any other switching circuit) to handle inductive loads (such as motors, solenoids, relays, etc.) the switching circuit needs to be protected from high voltages that can be generated when the circuit is opened.</p>

<p>One characteristic of inductors is that they would like to keep the current that is flowing through them a constant. When the switch suddenly interrupts the flow of current to the inductor, the magnetic energy stored in the inductor is dissipated by building up a large negative voltage across the inductor. This could damage the switching circuit.</p>

<p>In order to prevent this, switching circuits that drive inductive loads require a diode that is reverse-biased to be placed across the switch. The diode conducts the negative voltage generated by the inductor away from the switch. These diodes are called flyback diodes or clamp diodes.</p>

<p>Many switching circuits such as the popular L293D H-bridge IC already include a flyback diode in the output circuit. Remember to always check the datasheet for the driver that you are using to determine whether a flyback diode is inbuilt or not.</p>

<h2 id="stepper-motors">Stepper Motors</h2>
<p>A stepper motor moves its rotor in incremental “steps” around its axis based on an input that consists of a series of pulses. Each pulse results in an increment of one step around the axis of the motor.</p>

<p>The figure below (from Wikimedia Commons) shows an animation of how a typically stepper motor functions.</p>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/6/67/StepperMotor.gif" alt="Stepper motor representation" /></p>


  </article>

</div>

        <!-- Footer -->
        
      <footer>

  <div class="row">
    
    <div class="col-lg-6">
      Copyright &copy; PFactor.io 2015
    </div>
    <div class="col-lg-6">
      <span class="pull-right">
      
      <a title="Share on Facebook" href="http://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fpfactor.io%2Fiot%2Ftutorials%2Flesson_04%2F&display=popup">
          <span class="fa-stack fa-lg">
          <i class="fa fa-circle fa-stack-2x"></i>
          <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
          </span>
        </a>
      
      
        <a href="http://twitter.com/pfactorio/">
          <span class="fa-stack fa-lg">
          <i class="fa fa-circle fa-stack-2x"></i>
          <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
          </span>
        </a> 
      
      
        <a href="http://github.com/pfactorio/">
          <span class="fa-stack fa-lg">
          <i class="fa fa-circle fa-stack-2x"></i>
          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
          </span>
        </a>
         
      </span>
    </div>
  </div>  
  
  
  
<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'pfactorio';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>  
  
</footer>
    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="/js/jquery.js"></script>
      
    <!-- Open external links in new tab -->
    <script>
      $('a[href^=http]').click(function () {
      var a = new RegExp('/' + window.location.host + '/');
      if (!a.test(this.href)) {
        window.open(this.href);
        return false;
       }
      });
    </script>
    
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Script to Activate the Carousel -->
    <script>
    $('.carousel').carousel({
        interval: 5000 //changes the speed
    })
    </script>
  </body>
</html>
